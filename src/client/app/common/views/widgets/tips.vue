<template>
<div class="mkw-tips">
	<p ref="tip"><fa :icon="['far', 'lightbulb']"/><span v-html="tip"></span></p>
</div>
</template>

<script lang="ts">
import anime from 'animejs';
import { defineComponent } from 'vue';
import define from '../../../common/define-widget-define-component';
import { i18n as _i18n } from '../../../i18n';

const widget = define({
	name: 'tips',
});

export default defineComponent({
	extends: widget,

	data() {
		return {
			tips: [],
			tip: null,
			clock: null,
			i18n: _i18n('common/views/widgets/tips.vue'),
		};
	},
	created() {
		console.log(this.i18n.t('tips-line1'))
		this.tips = [
			this.i18n.t('tips-line1'),
			this.i18n.t('tips-line2'),
			this.i18n.t('tips-line3'),
			this.i18n.t('tips-line4'),
			this.i18n.t('tips-line5'),
			this.i18n.t('tips-line6'),
			this.i18n.t('tips-line7'),
			this.i18n.t('tips-line8'),
			this.i18n.t('tips-line9'),
			this.i18n.t('tips-line10'),
			this.i18n.t('tips-line11'),
			this.i18n.t('tips-line13'),
			this.i18n.t('tips-line14'),
			this.i18n.t('tips-line17'),
			this.i18n.t('tips-line19'),
			this.i18n.t('tips-line20'),
			this.i18n.t('tips-line21'),
			this.i18n.t('tips-line23'),
			this.i18n.t('tips-line24'),
			this.i18n.t('tips-line25'),
		];
	},
	mounted() {
		this.$nextTick(() => {
			this.set();
		});

		this.clock = setInterval(this.change, 20000);
	},
	beforeUnmount() {
		clearInterval(this.clock);
	},
	methods: {
		set() {
			this.tip = this.tips[Math.floor(Math.random() * this.tips.length)];
		},
		change() {
			anime({
				targets: this.$refs.tip,
				opacity: 0,
				duration: 500,
				easing: 'linear',
				complete: this.set,
			});

			setTimeout(() => {
				anime({
					targets: this.$refs.tip,
					opacity: 1,
					duration: 500,
					easing: 'linear',
				});
			}, 500);
		},
	},
});
</script>

<style lang="stylus" scoped>
.mkw-tips
	overflow visible !important
	opacity 0.8

	> p
		display block
		margin 0
		padding 0 12px
		text-align center
		font-size 0.7em
		color var(--text)

		> [data-icon]
			margin-right 4px

		kbd
			display inline
			padding 0 6px
			margin 0 2px
			font-size 1em
			font-family inherit
			border solid 1px var(--text)
			border-radius 2px

</style>
